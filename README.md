# Лабораторная работа №8  
## Параллелизация явной схемы для уравнения теплопроводности  

**Студент:** [Ваше ФИО]  
**Группа:** ИУ7-65Б  
**Дата:** 2025-10-28  

---

## Содержание
- [1. Цель работы](#1-цель-работы)
- [2. Теоретическая часть](#2-теоретическая-часть)
  - [2.1. Математическая постановка](#21-математическая-постановка)
  - [2.2. MPI-функции](#22-mpi-функции)
- [3. Реализация](#3-реализация)
  - [3.1. Структура](#31-структура)
  - [3.2. Особенности](#32-особенности)
  - [3.3. Запуск](#33-запуск)
- [4. Эксперименты](#4-эксперименты)
  - [4.1. Параметры](#41-параметры)
  - [4.2. Условия](#42-условия)
  - [4.3. Результаты](#43-результаты)
- [5. Визуализация](#5-визуализация)
- [6. Анализ](#6-анализ)
- [7. Контрольные вопросы](#7-контрольные-вопросы)
- [8. Заключение](#8-заключение)
- [9. Приложения](#9-приложения)

---

## 1. Цель работы
Освоить **параллелизацию сеточных задач** на примере **явной схемы** для **одномерного нелинейного уравнения теплопроводности**.  

**Задачи:**
- Распределение данных
- Организация коммуникаций
- Сравнение эффективности подходов

---

## 2. Теоретическая часть

### 2.1. Математическая постановка
```math
\begin{cases}
\varepsilon \frac{\partial^2 u}{\partial x^2} - \frac{\partial u}{\partial t} = -u \frac{\partial u}{\partial x} - u^3, \\
x \in (0,1), \, t \in (0,T], \\
u(0,t) = -1, \quad u(1,t) = 1, \\
u(x,0) = \sin(3\pi(x - 1/6)).
\end{cases}
Явная схема:
$$u_n^{m+1} = u_n^m + \varepsilon \frac{\tau}{h^2} (u_{n+1}^m - 2u_n^m + u_{n-1}^m) + \frac{\tau}{2h} u_n^m (u_{n+1}^m - u_{n-1}^m) + \tau (u_n^m)^3
$$
Условие устойчивости:
$$\tau \leq 0.8 \cdot \frac{h^2}{2\varepsilon}, \quad \varepsilon = 10^{-1.5}
$$

2.2. MPI-функции

































ФункцияНазначениеGet_size(), Get_rank()Количество и ранг процессаbcast()Рассылка параметровScatterv(), Gatherv()Распределение/сбор данныхSendrecv()Обмен ореоламиCreate_cart()1D-топологияShift()Определение соседей

3. Реализация
3.1. Структура
textСвернутьПереносКопировать├── serial.py           → Последовательная
├── scatter_gather.py   → Scatterv/Gatherv
├── cart_sendrecv.py    → Sendrecv + Create_cart
├── plot_results.py     → Генерация графиков
└── results.txt         → Логи
3.2. Особенности

Ореолы → +2 элемента на процесс
Два слоя → u[0], u[1]
Авто-выбор τ → устойчивость
Прогресс-бар → каждые 10%

3.3. Запуск
bashСвернутьПереносИсполнитьКопировать# Установка
pip install mpi4py numpy matplotlib

# Последовательная
python3 serial.py

# Параллельные
mpirun --oversubscribe -np 4 python3 cart_sendrecv.py
mpirun --oversubscribe -np 8 python3 scatter_gather.py

4. Эксперименты
4.1. Параметры

































ПараметрЗначениеN400h0.0025ε10-1.5τ7.91 × 10-5M75895T6.0

Для Scatter/Gather: T = 0.6 → M = 7590

4.2. Условия

Среда: WSL2 (Ubuntu), Python 3.10, OpenMPI 4.1.5
Запуски: по 1 (стабильно)

4.3. Результаты
Время выполнения (сек)









































ПроцессовПоследовательнаяCart+SendrecvScatter/Gather (T=0.6)165.39——2—43.404.364—40.474.048—26.672.8016—58.483.54
Ускорение (относительно 65.39 сек)



































ПроцессовCart+SendrecvScatter/Gather (T=0.6)11.00×—21.51×15.0×41.62×16.2×82.45×23.4×161.12×18.5×

5. Визуализация





















ГрафикОписание<img src="images/execution_time.png" alt="Время">Время выполнения<img src="images/speedup.png" alt="Ускорение">Ускорение<img src="images/efficiency.png" alt="Эффективность">Эффективность

6. Анализ

Максимальное ускорение: 2.45× на 8 процессах
Падение на 16: N_local ≈ 25 → коммуникации > вычисления
Cart+Sendrecv эффективнее: 2 значения/шаг
Scatter/Gather проигрывает: весь слой

Узкие места:

MPI в WSL2
Python GIL
Много коммуникаций


7. Контрольные вопросы

Почему Scatterv/Gatherv хуже?
→ Передают весь слой, а не ореолы → O(N) данных.
Зачем Create_cart?
→ Автоматически определяет соседей.
Почему падает ускорение на 16 процессах?
→ Мало работы на процесс.
Как обеспечить устойчивость?
→ τ ≤ 0.8 · h² / (2ε)


8. Заключение

























ПунктРезультатРеализовано3 версииУстойчивостьОбеспеченаУскорениедо 2.45×Лучший подходSendrecv + Create_cart
Перспективы:

Numba / C++
Неявная схема
2D-сетка


9. Приложения
Файлы

serial.py, scatter_gather.py, cart_sendrecv.py
plot_results.py → графики
results.txt → логи

Библиотеки
textСвернутьПереносКопироватьPython 3.10+
mpi4py 3.1.5
numpy 1.24+
matplotlib 3.7+
OpenMPI 4.1.5

Отчёт подготовлен в рамках курса "Параллельные вычисления"
